<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vice CRM - الإعدادات</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="settings-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Override to show dashboard by default */
        .dashboard {
            display: block !important;
        }
    </style>
</head>
<body>
    <div class="dashboard active">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="dashboard-logo">
                    <div class="vice-logo">
                        <span id="systemName">Vice</span>
                        <span class="crm-badge" id="systemBadge">CRM</span>
                    </div>
                </div>
                
                <nav class="main-nav">
                    <a href="dashboard.html" class="nav-item">لوحة التحكم</a>
                    <a href="marketing.html" class="nav-item dropdown">التسويق</a>
                    <a href="sales.html" class="nav-item dropdown">المبيعات</a>
                    <a href="inventory.html" class="nav-item dropdown">المخزون</a>
                    <a href="client.html" class="nav-item">العملاء</a>
                    <a href="reports.html" class="nav-item dropdown">التقارير</a>
                    <a href="network.html" class="nav-item dropdown">الشبكة</a>
                    <a href="settings.html" class="nav-item active">الإعدادات</a>
                </nav>
                
                <div class="user-section">
                    <div class="user-actions">
                        <button class="action-btn" title="البحث">
                            <i class="fas fa-search"></i>
                        </button>
                        <button class="action-btn" title="الإشعارات">
                            <i class="fas fa-bell"></i>
                        </button>
                        <button class="action-btn" title="الرسائل">
                            <i class="fas fa-envelope"></i>
                        </button>
                        <button class="action-btn" title="التقويم">
                            <i class="fas fa-calendar"></i>
                        </button>
                        <button class="action-btn" title="المهام">
                            <i class="fas fa-tasks"></i>
                        </button>
                        <button class="action-btn" title="التحميل">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                    <div class="user-info">
                        <span>مرحباً، محمود</span>
                        <div class="user-avatar">م</div>
                        <button class="action-btn" title="تسجيل الخروج">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                    <button class="menu-toggle" onclick="toggleMobileSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="dashboard-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <ul class="sidebar-menu">
                    <li>
                        <a href="dashboard.html">
                            <i class="fas fa-chart-line"></i>
                            لوحة التحكم
                        </a>
                    </li>
                    <li>
                        <a href="marketing.html">
                            <i class="fas fa-bullhorn"></i>
                            التسويق
                        </a>
                    </li>
                    <li>
                        <a href="sales.html">
                            <i class="fas fa-handshake"></i>
                            المبيعات
                        </a>
                    </li>
                    <li>
                        <a href="inventory.html">
                            <i class="fas fa-boxes"></i>
                            المخزون
                        </a>
                    </li>
                    <li>
                        <a href="client.html">
                            <i class="fas fa-users"></i>
                            العملاء
                        </a>
                    </li>
                    <li>
                        <a href="reports.html">
                            <i class="fas fa-file-alt"></i>
                            التقارير
                        </a>
                    </li>
                    <li>
                        <a href="network.html">
                            <i class="fas fa-network-wired"></i>
                            الشبكة
                        </a>
                    </li>
                    <li>
                        <a href="settings.html" class="active">
                            <i class="fas fa-cog"></i>
                            الإعدادات
                        </a>
                    </li>
                </ul>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <div class="page-header">
                    <div class="breadcrumb">
                        <a href="dashboard.html">لوحة التحكم</a>
                        <i class="fas fa-chevron-left"></i>
                        <span>الإعدادات</span>
                    </div>
                    <h1 class="page-title">إعدادات النظام</h1>
                    <div class="page-actions">
                        <button class="btn btn-success" onclick="saveAllSettings()">
                            <i class="fas fa-save"></i>
                            حفظ جميع الإعدادات
                        </button>
                        <button class="btn btn-secondary" onclick="resetToDefaults()">
                            <i class="fas fa-undo"></i>
                            إعادة تعيين
                        </button>
                    </div>
                </div>

                <!-- Settings Tabs -->
                <div class="settings-container" style="background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
                    <div class="settings-tabs">
                        <button class="settings-tab active" onclick="switchSettingsTab('general')">
                            <i class="fas fa-cog"></i> إعدادات عامة
                        </button>
                        <button class="settings-tab" onclick="switchSettingsTab('branding')">
                            <i class="fas fa-palette"></i> العلامة التجارية
                        </button>
                        <button class="settings-tab" onclick="switchSettingsTab('users')">
                            <i class="fas fa-users"></i> إدارة المستخدمين
                        </button>
                        <button class="settings-tab" onclick="switchSettingsTab('security')">
                            <i class="fas fa-shield-alt"></i> الأمان
                        </button>
                        <button class="settings-tab" onclick="switchSettingsTab('backup')">
                            <i class="fas fa-database"></i> النسخ الاحتياطي
                        </button>
                    </div>

                    <!-- General Settings Tab -->
                    <div id="general-tab" class="settings-tab-content" style="padding: 30px;">
                        <h3 style="font-size: 1.4rem; font-weight: 600; color: #333; margin-bottom: 25px;">الإعدادات العامة</h3>
                        
                        <div class="settings-grid">
                            <!-- System Information -->
                            <div class="settings-section">
                                <h4 class="section-title">معلومات النظام</h4>
                                <div class="form-group">
                                    <label class="form-label">اسم النظام</label>
                                    <input type="text" id="systemNameInput" value="Vice CRM" class="form-input" placeholder="أدخل اسم النظام">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">إصدار النظام</label>
                                    <input type="text" id="systemVersion" value="الإصدار 5" class="form-input" placeholder="أدخل إصدار النظام">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">وصف النظام</label>
                                    <textarea id="systemDescription" rows="3" class="form-input" placeholder="أدخل وصف النظام">إصدار قادة السوق العقاري</textarea>
                                </div>
                            </div>

                            <!-- Language & Region -->
                            <div class="settings-section">
                                <h4 class="section-title">اللغة والمنطقة</h4>
                                <div class="form-group">
                                    <label class="form-label">اللغة الافتراضية</label>
                                    <select id="defaultLanguage" class="form-input">
                                        <option value="ar" selected>العربية</option>
                                        <option value="en">English</option>
                                        <option value="fr">Français</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">المنطقة الزمنية</label>
                                    <select id="timezone" class="form-input">
                                        <option value="Asia/Riyadh" selected>الرياض (GMT+3)</option>
                                        <option value="Asia/Dubai">دبي (GMT+4)</option>
                                        <option value="Africa/Cairo">القاهرة (GMT+2)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">تنسيق التاريخ</label>
                                    <select id="dateFormat" class="form-input">
                                        <option value="dd-mm-yyyy" selected>يوم-شهر-سنة</option>
                                        <option value="mm-dd-yyyy">شهر-يوم-سنة</option>
                                        <option value="yyyy-mm-dd">سنة-شهر-يوم</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Branding Settings Tab -->
                    <div id="branding-tab" class="settings-tab-content" style="padding: 30px; display: none;">
                        <h3 style="font-size: 1.4rem; font-weight: 600; color: #333; margin-bottom: 25px;">إعدادات العلامة التجارية</h3>
                        
                        <div class="settings-grid">
                            <!-- Logo Settings -->
                            <div class="settings-section">
                                <h4 class="section-title">الشعار والهوية</h4>
                                <div class="form-group">
                                    <label class="form-label">اسم الشركة</label>
                                    <input type="text" id="companyName" value="Vice" class="form-input" placeholder="أدخل اسم الشركة">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">شارة النظام</label>
                                    <input type="text" id="systemBadgeText" value="CRM" class="form-input" placeholder="أدخل شارة النظام">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">رفع شعار الشركة</label>
                                    <div class="custom-file-upload">
                                        <input type="file" id="logoUpload" accept="image/*" class="file-input">
                                        <button type="button" class="file-upload-btn" onclick="document.getElementById('logoUpload').click()">
                                            <span class="upload-icon">📁</span>
                                            <span class="upload-text">اختر ملف الشعار</span>
                                        </button>
                                        <div class="file-info">
                                            <small class="file-hint">يُفضل PNG أو SVG بحجم 200x60 بكسل</small>
                                            <div id="selectedFileName" class="selected-file"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="logo-preview">
                                    <div class="preview-header">معاينة الشعار</div>
                                    <div class="preview-logo" id="logoPreviewContainer">
                                        <span id="previewCompanyName">Vice</span>
                                        <span class="preview-badge" id="previewBadge">CRM</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Color Theme -->
                            <div class="settings-section">
                                <h4 class="section-title">الألوان والثيم</h4>
                                <div class="color-picker-grid">
                                    <div class="form-group">
                                        <label class="form-label">اللون الأساسي</label>
                                        <div class="color-input-wrapper">
                                            <input type="color" id="primaryColor" value="#667eea" class="color-input">
                                            <input type="text" id="primaryColorText" value="#667eea" class="color-text-input" placeholder="#667eea">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">اللون الثانوي</label>
                                        <div class="color-input-wrapper">
                                            <input type="color" id="secondaryColor" value="#764ba2" class="color-input">
                                            <input type="text" id="secondaryColorText" value="#764ba2" class="color-text-input" placeholder="#764ba2">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">لون الخلفية</label>
                                        <div class="color-input-wrapper">
                                            <input type="color" id="backgroundColor" value="#f8f9fa" class="color-input">
                                            <input type="text" id="backgroundColorText" value="#f8f9fa" class="color-text-input" placeholder="#f8f9fa">
                                        </div>
                                    </div>
                                </div>
                                <div class="color-preview" id="colorPreview">
                                    <div class="preview-header">معاينة الألوان</div>
                                    <div class="preview-content">هذا مثال على الألوان المختارة</div>
                                    <div class="preview-buttons">
                                        <button type="button" class="preview-btn primary">زر أساسي</button>
                                        <button type="button" class="preview-btn secondary">زر ثانوي</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Users Management Tab -->
                    <div id="users-tab" class="settings-tab-content" style="padding: 30px; display: none;">
                        <h3 style="font-size: 1.4rem; font-weight: 600; color: #333; margin-bottom: 25px;">إدارة المستخدمين</h3>
                        
                        <div class="users-actions" style="margin-bottom: 25px;">
                            <button class="btn btn-primary" onclick="showAddUserModal()">
                                <i class="fas fa-user-plus"></i>
                                إضافة مستخدم جديد
                            </button>
                            <button class="btn btn-secondary">
                                <i class="fas fa-upload"></i>
                                استيراد مستخدمين
                            </button>
                        </div>

                        <div class="users-table" style="background: #f8f9fa; border-radius: 8px; overflow: hidden;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead style="background: #667eea; color: white;">
                                    <tr>
                                        <th style="padding: 15px; text-align: right;">الاسم</th>
                                        <th style="padding: 15px; text-align: right;">البريد الإلكتروني</th>
                                        <th style="padding: 15px; text-align: right;">الدور</th>
                                        <th style="padding: 15px; text-align: right;">الحالة</th>
                                        <th style="padding: 15px; text-align: right;">آخر دخول</th>
                                        <th style="padding: 15px; text-align: right;">الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="border-bottom: 1px solid #dee2e6;">
                                        <td style="padding: 15px;">محمود أحمد</td>
                                        <td style="padding: 15px;">mahmoud2@kmg.com</td>
                                        <td style="padding: 15px;"><span style="background: #28a745; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem;">مدير النظام</span></td>
                                        <td style="padding: 15px;"><span style="background: #d4edda; color: #155724; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem;">نشط</span></td>
                                        <td style="padding: 15px;">الآن</td>
                                        <td style="padding: 15px;">
                                            <button class="action-icon" style="width: 32px; height: 32px; border: none; border-radius: 6px; background: #e3f2fd; color: #1976d2; cursor: pointer; margin-left: 5px;">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="action-icon" style="width: 32px; height: 32px; border: none; border-radius: 6px; background: #ffebee; color: #d32f2f; cursor: pointer;">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Security Settings Tab -->
                    <div id="security-tab" class="settings-tab-content" style="padding: 30px; display: none;">
                        <h3 style="font-size: 1.4rem; font-weight: 600; color: #333; margin-bottom: 25px;">إعدادات الأمان</h3>
                        
                        <div class="settings-grid">
                            <!-- Password Policy -->
                            <div class="settings-section">
                                <h4 class="section-title">سياسة كلمات المرور</h4>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="requireStrongPassword" checked>
                                        <span>طلب كلمات مرور قوية</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">الحد الأدنى لطول كلمة المرور</label>
                                    <input type="number" id="minPasswordLength" value="8" min="6" max="20" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">انتهاء صلاحية كلمة المرور (أيام)</label>
                                    <input type="number" id="passwordExpiry" value="90" min="30" max="365" class="form-input">
                                </div>
                            </div>

                            <!-- Session Settings -->
                            <div class="settings-section">
                                <h4 class="section-title">إعدادات الجلسة</h4>
                                <div class="form-group">
                                    <label class="form-label">مدة الجلسة (دقائق)</label>
                                    <input type="number" id="sessionTimeout" value="60" min="15" max="480" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="enableTwoFactor">
                                        <span>تفعيل المصادقة الثنائية</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="logLoginAttempts" checked>
                                        <span>تسجيل محاولات تسجيل الدخول</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Backup Settings Tab -->
                    <div id="backup-tab" class="settings-tab-content" style="padding: 30px; display: none;">
                        <h3 style="font-size: 1.4rem; font-weight: 600; color: #333; margin-bottom: 25px;">النسخ الاحتياطي والاستعادة</h3>
                        
                        <div class="backup-actions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <!-- Create Backup -->
                            <div class="backup-card" style="background: #f8f9fa; border-radius: 12px; padding: 25px; text-align: center; border: 1px solid #dee2e6;">
                                <div class="backup-icon" style="width: 60px; height: 60px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem;">
                                    <i class="fas fa-download"></i>
                                </div>
                                <h4 style="font-size: 1.1rem; font-weight: 600; color: #333; margin-bottom: 10px;">إنشاء نسخة احتياطية</h4>
                                <p style="color: #6c757d; margin-bottom: 20px; font-size: 0.9rem;">إنشاء نسخة احتياطية كاملة من البيانات</p>
                                <button class="btn btn-success" onclick="createBackup()" style="width: 100%;">
                                    <i class="fas fa-download"></i>
                                    إنشاء نسخة احتياطية
                                </button>
                            </div>

                            <!-- Restore Backup -->
                            <div class="backup-card" style="background: #f8f9fa; border-radius: 12px; padding: 25px; text-align: center; border: 1px solid #dee2e6;">
                                <div class="backup-icon" style="width: 60px; height: 60px; background: linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem;">
                                    <i class="fas fa-upload"></i>
                                </div>
                                <h4 style="font-size: 1.1rem; font-weight: 600; color: #333; margin-bottom: 10px;">استعادة النسخة الاحتياطية</h4>
                                <p style="color: #6c757d; margin-bottom: 20px; font-size: 0.9rem;">استعادة البيانات من نسخة احتياطية</p>
                                <input type="file" id="backupFile" accept=".json,.sql" style="display: none;">
                                <button class="btn btn-primary" onclick="document.getElementById('backupFile').click()" style="width: 100%;">
                                    <i class="fas fa-upload"></i>
                                    اختيار ملف الاستعادة
                                </button>
                            </div>

                            <!-- Auto Backup -->
                            <div class="backup-card" style="background: #f8f9fa; border-radius: 12px; padding: 25px; text-align: center; border: 1px solid #dee2e6;">
                                <div class="backup-icon" style="width: 60px; height: 60px; background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 1.5rem;">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <h4 style="font-size: 1.1rem; font-weight: 600; color: #333; margin-bottom: 10px;">النسخ التلقائي</h4>
                                <p style="color: #6c757d; margin-bottom: 20px; font-size: 0.9rem;">جدولة النسخ الاحتياطي التلقائي</p>
                                <select id="autoBackupFrequency" class="form-input" style="margin-bottom: 15px;">
                                    <option value="disabled">معطل</option>
                                    <option value="daily">يومي</option>
                                    <option value="weekly" selected>أسبوعي</option>
                                    <option value="monthly">شهري</option>
                                </select>
                                <button class="btn btn-warning" onclick="saveAutoBackupSettings()" style="width: 100%;">
                                    <i class="fas fa-save"></i>
                                    حفظ الإعدادات
                                </button>
                            </div>
                        </div>

                        <!-- Recent Backups -->
                        <div class="recent-backups" style="background: white; border-radius: 8px; padding: 20px; border: 1px solid #dee2e6;">
                            <h4 style="font-size: 1.1rem; font-weight: 600; color: #333; margin-bottom: 15px;">النسخ الاحتياطية الأخيرة</h4>
                            <div class="backups-list">
                                <div class="backup-item" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #f0f0f0;">
                                    <div>
                                        <div style="font-weight: 600; color: #333;">نسخة احتياطية كاملة</div>
                                        <div style="font-size: 0.9rem; color: #6c757d;">19-أغسطس-2025 - 2:30 ص</div>
                                        <div style="font-size: 0.8rem; color: #6c757d;">حجم الملف: 45.2 MB</div>
                                    </div>
                                    <div style="display: flex; gap: 8px;">
                                        <button class="action-icon" style="width: 32px; height: 32px; border: none; border-radius: 6px; background: #e3f2fd; color: #1976d2; cursor: pointer;">
                                            <i class="fas fa-download"></i>
                                        </button>
                                        <button class="action-icon" style="width: 32px; height: 32px; border: none; border-radius: 6px; background: #ffebee; color: #d32f2f; cursor: pointer;">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Mobile Sidebar -->
        <div class="mobile-sidebar" id="mobileSidebar">
            <div class="mobile-sidebar-header">
                <div class="vice-logo">
                    <span id="mobileSysName">Vice</span>
                    <span class="crm-badge" id="mobileSysBadge">CRM</span>
                </div>
                <button class="close-sidebar" onclick="toggleMobileSidebar()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <ul class="sidebar-menu">
                <li><a href="dashboard.html"><i class="fas fa-chart-line"></i> لوحة التحكم</a></li>
                <li><a href="marketing.html"><i class="fas fa-bullhorn"></i> التسويق</a></li>
                <li><a href="sales.html"><i class="fas fa-handshake"></i> المبيعات</a></li>
                <li><a href="inventory.html"><i class="fas fa-boxes"></i> المخزون</a></li>
                <li><a href="client.html"><i class="fas fa-users"></i> العملاء</a></li>
                <li><a href="reports.html"><i class="fas fa-file-alt"></i> التقارير
